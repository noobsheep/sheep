<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>新用户注册 - 当当网</title>
    <link href="../image/timg.jpg" rel="shortcut icon" type="image/x-icon">
    <link href="image/timg.jpg" rel="shortcut icon" type="image/x-icon">
    <link href="../css/register.css" rel="stylesheet" type="text/css">
    <script src="../node_modules/_jquery@1.11.3@jquery/dist/jquery.js"></script>
    <link href="../node_modules/bootstrap/dist/css/bootstrap.css" rel="stylesheet" />
    <script src="../node_modules/bootstrap/dist/js/bootstrap.js""></script>
    
</head>
<body>
    <div class=" head">
        <div class="logo">
            <img src="../image/logomin.gif">
        </div>
        <div class="head_nav">
            <div class="head_nav_list">
                <ul>
                    <li><span class="glyphicon glyphicon-shopping-cart">&nbsp;</span>购物车</li>
                    <li class="fenge"></li>
                    <li>我的订单</li>
                    <li class="fenge"></li>
                    <li>我的当当</li>
                    <li class="fenge"></li>
                    <li>礼品卡</li>
                    <li class="fenge"></li>
                    <li>手机当当</li>
                    <li class="fenge"></li>
                    <li>企业销售</li>
                    <li class="fenge"></li>
                    <li>帮助</li>
                </ul>
                <p>欢迎光临当当网，请登陆<a href="#">登陆</a>&nbsp;&nbsp;<a href="#">免费注册</a></p>
            </div>
        </div>
    </div>   
        <div class="mid">
            <div class="mid_top">
                <div class="mid_top_tit">
                    <p class="p_on">新用户注册</p>
                    <p>企业用户注册</p>
                    <div class="mid_top_list">
                        <span class="glyphicon glyphicon-home"></span> 
                        <span><a href="../index.html">当当首页<a/></span>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span><a href="http://help.dangdang.com/details/page2">注册帮助</a></span>
                    </div>
                </div>
                
            </div>
            <div class="mid_info">
                <div class="mid_info_tip">
                    <p>贴心提示：请勿设置与邮箱密码相同的账户登录密码或支付密码，防止不法分子窃取您的当当账户信息，<a href="#">谨防诈骗！</a></p>
                </div>
                <div class="mid_info_foot">
                <div class="inputs">
                    <div class="tx">手机号码 &nbsp;</div>
                    <div class="br"><input type="text" placeholder="请输入您的手机号" id="pho"  ></div>
                    <span id="phospan">&nbsp;手机号格式不正确</span>
                </div>
               <div class="inputs">
                        <div class="tx">登陆密码 &nbsp;</div>
                        <div class="br"><input type="text" id="pas"></div>
                    <span id="passpan">&nbsp;密码的格式不正确</span>
                </div>
                <div class="inputs">
                    <div class="tx">邮箱账号 &nbsp;</div>
                    <div class="br"><input type="text" id="yx" ></div>
                    <span id="yxspan">&nbsp;邮箱格式不对</span>
                </div>
                <div class="inputs">
                        <div class="txz">验证码 &nbsp;</div>
                        <div class="brz"><input id="yz_code" type="text"></div>
                        <div id="v_container" style="width: 90px;height: 38px;margin-left: 10px;"></div>
                        <span id="yzm">验证码错误</span>
                </div>
               <p class="checks"><input type="checkbox">我已阅读并同意 <a href="#">《当当交易条款》</a>和 <a href="#">《当当社区条款》</a></p>
               <button class="but" id="my_button" >立即注册<tutton>
            </div>
        </div>
        <hr />
        <div class="footer_nav_box">
            <div class="footer_nav"><a href="http://static.dangdang.com/topic/2227/176801.shtml" target="_blank"
                    rel="nofollow">公司简介</a><span class="sep">|</span><a href="http://zhaopin.dangdang.com"
                    target="_blank">诚聘英才</a><span class="sep">|</span><a
                    href="http://static.dangdang.com/topic/744/200778.shtml" target="_blank">手机当当</a><span
                    class="sep">|</span><a href="http://union.dangdang.com/" target="_blank">网站联盟</a><span
                    class="sep">|</span><a href="http://outlets.dangdang.com/merchants_open" target="_blank">当当招商</a><span
                    class="sep">|</span><a href="http://misc.dangdang.com/groupbuy/Default.aspx" target="_blank"
                    rel="nofollow">机构销售</a><span class="sep">|</span><a href="http://blog.dangdang.com/"
                    target="_blank">官方Blog</a>
    
            </div>
            <div class="footer_copyright"><span>Copyright (C) 当当网 2004-2017, All Rights Reserved</span></div>
            <div class="footer_copyright"><span><a href="http://www.miibeian.gov.cn/" target="_blank"
                        rel="nofollow">京ICP证041189号</a></span><span class="sep">|</span><span>出版物经营许可证
                    新出发京批字第直0673号</span><span
                    class="sep">|</span><span>食品流通许可证：SP1101011010021855(1-1)</span><br><span>互联网药品信息服务资格证编号：(京)-非经营性-2012-0016</span><span
                    class="sep">|</span><span>京公网安备110101000001号</span></div>
            <!-- 有三个icon的时候加footer_icon2 -->
            <div class="footer_icon footer_icon2" style="padding-left: 55px;">
                <div class="validator"><a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001051000098"
                        target="_blank" class="footer_img"><img src="../image/ccc.png"></a></div>
                <div class="validator"><a href="http://bj429.com.cn/" target="_blank" class="footer_img"><img
                            src="../image/ccc2.png"></a></div>
                <div class="validator"><a id="_pingansec_bottomimagesmall_brand"
                        href="http://si.trustutn.org/info?sn=302161014024825726885&certType=1" target="_blank"><img
                            src="../image/ccc3.gif"></a></div>
                </a>
            </div>
            <div class="clear"></div>
        </div>
        </div>
    
        <script src="../js/gVerify.js"></script>
    <script>

        //判断密码格式是否正确
        var pass = false;
        var passwd = document.getElementById("pas");
        var pspan = document.getElementById("passpan");
        passwd.onblur = function () {
            var passwdzz = /^\w{6,12}$/
            passwdvalue = passwdzz.test(passwd.value);
            console.log(passwdvalue)
            if (passwdvalue != true) {
                pspan.style.display = "block";
                pass = false;
            } else if (passwdvalue == true) {
                pspan.style.display = "none";
                pass = true;
            }

        }

        //判断邮箱格式是否正确
        var emt = false;
        var em = document.getElementById("yx");
        var emspan = document.querySelector("#yxspan")
        em.onblur = function () {
            var emzz = /^\w+@(126|163|qq)\.(com|cn|com\.cn)$/g;
            emzz1 = emzz.test(em.value)
            if (emzz1 != true) {
                emspan.style.display = "block";
                emt = false;
            } else if (emzz1 == true) {
                emspan.style.display = "none";
                emt = true;

            }
        }
        //判断电话号码格式是否正确
        var phonet = false;
        var phone = document.getElementById("pho");
        var pphone = document.querySelector("#phospan")
        phone.onblur = function () {
            console.log(phone.value);
            var phzz = /^(158|156|188)\d{8}$/
            phzz1 = phzz.test(phone.value)
            if (phzz1 != true) {
                pphone.style.display = "block";
                phonet = false;
            } else if (phzz1 == true) {
                pphone.style.display = "none";
                phonet = true;

            }
        }

        var option = {
            id: "v_container",
            canvasId: "verifyCanvas",
            width: "90",
            height: "38",
            length: 4
        }
        var verifyCode = new GVerify(option);
        var yzm = document.getElementById("yzm")
        document.getElementById("my_button").onblur = function () {
            var res = verifyCode.validate(document.getElementById("yz_code").value);
            if (res) {
                yzm.style.display = "none";
            } else {
                yzm.style.display = "block";
            }
        }

        var butt = document.getElementById("my_button");
            butt.onclick = function () {
                console.log($("#pho").val())
                console.log($("#pas").val())
                console.log($("#yx").val())
                if (phonet && emt && pass) {
                    $.post("http://47.104.244.134:8080/usersave.do", {
                        username: $("#pho").val(),
                        password: $("#pas").val(),
                        email: $("#yx").val(),
                        sex: "女"
                    }).done(data => {
                        console.log(data);
                        if (data.code == 0) {
                            alert("成功了,确定后3秒后跳转登陆页面")
                            setTimeout(function(){
                                location.href = "./login.html"
                            },3000)
                        } else {
                            alert("失败")
                        }
                    })
                } else {
                    alert("请内容检查格式")
                }

            }







    </script>
    </body>

</html>